{% load static %}
{% load block_tags %}
<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ website.title }}</title>
    <link rel="stylesheet" href="{% static 'base/css/view_website.css' %}">
    <style>
        :root {
            --font-family: {
                    {
                    website.font_family|default: "Arial, sans-serif"
                }
            }

            ;

            --background-color: {
                    {
                    website.background_color|default: "#ffffff"
                }
            }

            ;

            --text-color: {
                    {
                    website.text_color|default: "#000000"
                }
            }

            ;

            --header-background-color: {
                    {
                    website.header_background_color|default: "#ffffff"
                }
            }

            ;

            --header-text-color: {
                    {
                    website.header_text_color|default: "#000000"
                }
            }

            ;

            --footer-background-color: {
                    {
                    website.footer_background_color|default: "#f3f4f6"
                }
            }

            ;

            --footer-text-color: {
                    {
                    website.footer_text_color|default: "#000000"
                }
            }

            ;
        }
    </style>
</head>

<body>

    {% if website.header_show %}
    <header class="header">
        <div class="header-content">
            {% if website.header_logo %}
            <img src="{{ website.header_logo.url }}" alt="Logo" class="header-logo">
            {% endif %}
            {% if website.header_company_name %}
            <div class="header-company-name">{{ website.header_company_name }}</div>
            {% endif %}
        </div>
    </header>
    {% endif %}

    <main class="main-content">
        <div class="site-canvas">
            {% for block in blocks %}
            {% with data=block.get_data %}
            {# Собираем inline-стили на основе сохранённых данных блока (позиция и размеры) #}
            {# left/top/width/height ожидаются в пикселях (числа). Если нет — стиль не применяется. #}
            <div class="block-item"
                data-original-width="{% if data.width is not None and data.width|floatformat:'0' %}{{ data.width }}px{% endif %}"
                data-original-height="{% if data.height is not None and data.height|floatformat:'0' %}{{ data.height }}px{% endif %}"
                style="position: absolute; {% if data.position_x is not None %}left:{{ data.position_x }}px;{% endif %} {% if data.position_y is not None %}top:{{ data.position_y }}px;{% endif %} {% if data.width is not None %}width:{{ data.width }}px;{% endif %} {% if data.height is not None %}height:{{ data.height }}px;{% endif %}">
                {{ block|render_block }}
            </div>
            {% endwith %}
            {% empty %}
            <div style="text-align: center; padding: 3rem; color: #6b7280;">
                <p>На сайте пока нет контента.</p>
            </div>
            {% endfor %}
        </div>
    </main>

    {% if website.footer_show %}
    <footer class="footer">
        <div class="footer-content">
            {{ website.footer_content|safe }}
        </div>
    </footer>
    {% endif %}

    <script src="{% static 'base/js/view_website.js' %}"></script>
</body>

</html>